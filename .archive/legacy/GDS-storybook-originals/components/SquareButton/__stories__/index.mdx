import {
  Meta,
  Primary,
  Story,
  Canvas,
  ArgTypes,
} from "@storybook/addon-docs/blocks";
import SquareButton from "..";
import { DarkCanvas } from "../../../docs/DarkCanvas";
import PageButtonsDisabled from "../../../images/PageButtonsDisabled.png";
import CalendarButtonsDisabled from "../../../images/CalendarButtonsDisabled.png";
import * as stories from "./index.stories.tsx";

<Meta title="Components/SquareButton" of={stories} />

# SquareButton

Importing the square button component in your project:

`import { SquareButton } from "@ticketmaster/global-design-system";`

<Primary />

<ArgTypes of={SquareButton} />

## Variants

The `variant` prop defines what color from the theme we should use. Valid values are:

**`primary`** - this is the default if no `variant` prop is provided.

<Canvas of={stories.Primary} />

**`secondary`**

<Canvas of={stories.Secondary} />

**`tertiary`**

<Canvas of={stories.Tertiary} />

**`ghost`**

<Canvas of={stories.Ghost} />

**`inverse`**

<DarkCanvas>
  <Story of={stories.Inverse} />
  <Story of={stories.InverseDisabled} />
</DarkCanvas>

## Loading

To display a loading spinner in the button, eg to provide user feedback during asynchronous actions such as form submission or API calls,
you can provide a `loading` object prop to the button.

This includes an `isLoading` boolean prop, and mandatory `hiddenLoadingMessage` string. This message is assertively read out by assistive technology when the loading state is triggered.
This should be a descriptive message like "Form is submitting...".

<Canvas of={stories.Loading} />

## With Icons

Use the `icon` prop to render an icon inside the button instead of the default chevron. This should be a React node.

<Canvas of={stories.WithCheckmarkIcon} />
<Canvas of={stories.WithTrashIcon} />
<Canvas of={stories.WithCrossIcon} />

Icon sizes can be adjusted to suit. By default they are `1em` but can be tweaked individually with the `size` prop on the icon. They can also be rotated if required:

<Canvas of={stories.WithBigIcon} />
<Canvas of={stories.WithRotatedIcon} />

Note: Sizes bigger than `2em` or so will probably overflow the edges of a normal size button and start to look weird, so it's not recommended to use icons that big.

## As links

The element that a button component renders may occasionally need to be an `<a>` instead of a `<button>`.

Use the `as="a"` or `as={CustomLinkComponent}` prop for this, and make sure to include an `href`. See the examples below

<Canvas of={stories.Link} />

### Disabled links

Use `aria-disabled="true"` prop instead of `disabled` to set and style the link as disabled. `aria-disabled="true"` will also automatically assign `undefined` to `href`, preventing any interactions with it.

<Canvas of={stories.DisabledLink} />

<DarkCanvas>
  <Story of={stories.DisabledLinkInverse} />
</DarkCanvas>

## Accessibility

### Labels

`SquareButton` requires a `label` prop to help users of assistive technology know what the button is for. This should be descriptive, i.e. `"See more info about [Event name and time]"` or `"Delete [Item/ticket name] from basket"`.
This text will be visually hidden but read out by screen readers when the user focuses the button.

### WCAG Success Criterion

> 3.2.2 On Input: Changing the setting of any user interface component does not automatically cause a change of context unless the user has been advised of the behaviour before using the component.
> [Understanding Success Criterion 3.2.2: On Input](https://www.w3.org/WAI/WCAG21/quickref/#on-input)

### Disabled Button

The general recommendation is to avoid using disabled buttons unless thereâ€™s a good reason to.
Disabled buttons can create usability challenges and hinder user experience. Instead, it's best to design a user experience that guides users to achieve the desired action, promoting better accessibility and inclusivity.

#### When to Use Disabled Buttons

There are specific scenarios where using disabled buttons or links may be necessary to clarify or prevent users from taking inappropriate actions. Some examples include:

- In `PageButtons` component, disable the "previous page" link when the user is on the first page to indicate that there's no previous page available.
- In `Calendar` events, disabling days with no events to help keyboard-only and assistive technology users skip them and navigate available events effectively.

#### How to use Disabled Links

When we need a disabled link we use `aria-disabled="true"` prop, instead of `disabled` avaialable only for `<button>` and not for `<a>`.

<img
  src={PageButtonsDisabled}
  alt="Disabled Link in the pagination component"
/>
Image caption: `PageButtons` with disabled links.

<img
  src={CalendarButtonsDisabled}
  alt="Disabled Buttons used for days without events in the calendar component"
/>
Image caption: `Calendar` component with disabled day buttons.

#### Ensuring Perceivability and User Guidance

When using disabled buttons, it's crucial to ensure all users can perceive their disabled state.
Providing clear visual cues, appropriate text labels, or ARIA attributes for assistive technologies can help convey the button's status effectively. Additionally, include instructions or contextual information to inform users about the actions they need to take to activate the button when appropriate. E.g. [AlertBox](http://global-design-system.git.tmaws.io/gds/?path=/docs/components-alertbox--docs).

Please follow the recommendations listed in [Making Disabled Buttons More Inclusive](https://www.smashingmagazine.com/2021/08/frustrating-design-patterns-disabled-buttons/#making-disabled-buttons-more-inclusive)

#### Meeting Other Accessibility Criteria

While disabled buttons are not required to meet colour contrast standards, it's crucial to maintain adequate contrast for other active elements on the page.

Refer to [WCAG Criterion 1.4.3 Contrast (Minimum)](https://www.w3.org/WAI/WCAG21/Understanding/contrast-minimum.html#:~:text=Incidental,interface%20component%2C) for more information.
For a more comprehensive understanding of colour and contrast accessibility, you can explore [WebAIM's Contrast and Colour Accessibility](https://webaim.org/articles/contrast).
